<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KM Real World SQL</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>

<style>
/* =====================
   THEME VARIABLES
===================== */
:root {
  --bg: #0f172a;
  --card: #020617;
  --text: #e5e7eb;
  --muted: #94a3b8;
  --accent: #38bdf8;
  --border: #334155;
}

body.light {
  --bg: #f8fafc;
  --card: #ffffff;
  --text: #020617;
  --muted: #475569;
  --accent: #2563eb;
  --border: #cbd5e1;
}

/* =====================
   GLOBAL
===================== */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
}

.container {
  max-width: 900px;
  margin: auto;
  padding: 16px;
}

/* =====================
   HEADER (JobStreet style)
===================== */
.header {
  display: flex;
  align-items: center;
  gap: 12px;
}

.header img {
  width: 56px;
  height: 56px;
}

.header-text h1 {
  font-size: 1.4rem;
  margin: 0;
}

.header-text p {
  margin: 2px 0 0;
  font-size: 0.85rem;
  color: var(--muted);
}

.theme-toggle {
  margin-left: auto;
  cursor: pointer;
  font-size: 1.2rem;
}

/* =====================
   CARDS
===================== */
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 16px;
  margin-top: 16px;
}

.card h2 {
  margin-top: 0;
  font-size: 1.1rem;
}

/* =====================
   FORM ELEMENTS
===================== */
select, textarea, button {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  border-radius: 6px;
  border: 1px solid var(--border);
  background: var(--bg);
  color: var(--text);
  font-size: 1rem;
}

textarea {
  min-height: 180px;
  font-family: monospace;
}

button {
  background: var(--accent);
  color: #fff;
  font-weight: bold;
  cursor: pointer;
}

/* =====================
   RESULT TABLE
===================== */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}

th, td {
  border: 1px solid var(--border);
  padding: 8px;
  text-align: left;
}

/* =====================
   FOOTER
===================== */
footer {
  text-align: center;
  font-size: 0.75rem;
  color: var(--muted);
  margin: 24px 0 10px;
}
</style>
</head>

<body>

<div class="container">

  <!-- HEADER -->
  <div class="header">
    <img src="logo.png" alt="Logo">
    <div class="header-text">
      <h1>KM Real World SQL</h1>
      <p>Build SQL skills, brick by brick Â· By Mallesh Gangula</p>
    </div>
    <div class="theme-toggle" onclick="toggleTheme()">ðŸŒ™</div>
  </div>

  <!-- PRACTICE FIRST -->
  <div class="card">
    <h2>Practice SQL</h2>

    <select id="field" onchange="loadTasks()">
      <option value="office">Office</option>
      <option value="logistics">Logistics</option>
      <option value="hospital">Hospital</option>
    </select>

    <select id="level" onchange="loadTasks()">
      <option value="1">Level 1</option>
      <option value="2">Level 2</option>
    </select>

    <select id="taskSelect" onchange="loadTask()"></select>

    <textarea id="query"></textarea>
    <button onclick="runSQL()">Run Query</button>

    <div id="output"></div>
  </div>

  <!-- WHY THIS WORKS -->
  <div class="card">
    <h2>Why this works</h2>
    <p id="explain"></p>
  </div>

  <!-- EDUCATION BELOW -->
  <div class="card">
    <h2>What is SQL?</h2>
    <p>
      SQL is used by companies to read and analyze data stored in databases.
      This platform teaches SQL the way it is actually used at work.
    </p>
  </div>

  <div class="card">
    <h2>How to learn here</h2>
    <p>
      Start with simple queries, understand the logic, and practice repeatedly.
      Learning SQL is about thinking clearly, not memorizing syntax.
    </p>
  </div>

  <footer>
    Â© 2025 KM Real World SQL
  </footer>

</div>

<script>
/* =====================
   THEME TOGGLE
===================== */
function toggleTheme() {
  document.body.classList.toggle("light");
  localStorage.setItem("theme", document.body.classList.contains("light") ? "light" : "dark");
}

if (localStorage.getItem("theme") === "light") {
  document.body.classList.add("light");
}

/* =====================
   SQL DATA
===================== */
let db;

const tasks = {
  office: {
    1: [{
      title: "See all employees",
      query: "SELECT * FROM employees;",
      explain: "SELECT * fetches all columns from the employees table."
    }],
    2: [{
      title: "Salary greater than 30000",
      query: "SELECT * FROM employees WHERE salary > 30000;",
      explain: "WHERE filters rows based on conditions."
    }]
  },
  logistics: {
    1: [{
      title: "View all shipments",
      query: "SELECT * FROM shipments;",
      explain: "Used to monitor all shipments."
    }]
  },
  hospital: {
    1: [{
      title: "View all patients",
      query: "SELECT * FROM patients;",
      explain: "Hospitals use this to review patient data."
    }]
  }
};

function loadTasks() {
  taskSelect.innerHTML = "";
  const list = tasks[field.value][level.value] || [];
  list.forEach((t, i) => {
    const o = document.createElement("option");
    o.value = i;
    o.textContent = t.title;
    taskSelect.appendChild(o);
  });
  loadTask();
}

function loadTask() {
  const t = tasks[field.value][level.value][taskSelect.value];
  query.value = t.query;
  explain.innerText = t.explain;
  output.innerHTML = "";
}

function runSQL() {
  try {
    const r = db.exec(query.value);
    if (!r.length) {
      output.innerHTML = "No results";
      return;
    }
    let html = "<table><tr>";
    r[0].columns.forEach(c => html += `<th>${c}</th>`);
    html += "</tr>";
    r[0].values.forEach(row => {
      html += "<tr>";
      row.forEach(cell => html += `<td>${cell}</td>`);
      html += "</tr>";
    });
    html += "</table>";
    output.innerHTML = html;
  } catch {
    output.innerHTML = "SQL Error";
  }
}

initSqlJs({
  locateFile: f => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/${f}`
}).then(SQL => {
  db = new SQL.Database();
  db.run(`
    CREATE TABLE employees(id INT,name TEXT,salary INT);
    INSERT INTO employees VALUES (1,'Zeb',40000),(2,'Arjun',60000);

    CREATE TABLE shipments(id INT,status TEXT);
    INSERT INTO shipments VALUES (1,'Pending');

    CREATE TABLE patients(id INT,name TEXT);
    INSERT INTO patients VALUES (1,'Rahul');
  `);
  loadTasks();
});
</script>

</body>
</html>
