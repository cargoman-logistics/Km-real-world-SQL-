<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KM Real World SQL</title>

<style>
:root{
  --bg:#0f172a;
  --panel:#020617;
  --card:#020617;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --accent:#38bdf8;
  --border:#334155;
}
body.light{
  --bg:#f8fafc;
  --panel:#ffffff;
  --card:#ffffff;
  --text:#020617;
  --muted:#475569;
  --accent:#2563eb;
  --border:#cbd5e1;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:system-ui,Arial;
  background:var(--bg);
  color:var(--text);
}
.app{
  min-height:100vh;
  display:flex;
  flex-direction:column;
}

/* HEADER */
.header{
  display:flex;
  align-items:center;
  gap:12px;
  padding:14px 16px;
}
.header img{width:44px;height:44px}
.header h1{margin:0;font-size:1.3rem}
.header p{margin:2px 0 0;font-size:.8rem;color:var(--muted)}
.toggle{margin-left:auto;cursor:pointer;font-size:1.2rem}

/* MAIN */
.main{
  flex:1;
  padding:14px;
}

/* CARD */
.card{
  background:linear-gradient(180deg,var(--panel),transparent);
  border:1px solid var(--border);
  border-radius:14px;
  padding:16px;
  max-width:720px;
  margin:auto;
}

/* PROGRESS */
.bar{
  height:10px;
  background:#020617;
  border-radius:6px;
  overflow:hidden;
  margin:6px 0 14px;
}
.fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#38bdf8,#0ea5e9);
}

/* PRACTICE */
.practice{display:flex;flex-direction:column;gap:10px}
label{font-size:.8rem;color:var(--muted)}
select,textarea,button{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--bg);
  color:var(--text);
  font-size:1rem;
}
textarea{min-height:150px;font-family:monospace}
button{
  background:var(--accent);
  color:#fff;
  font-weight:600;
  cursor:pointer;
}

/* RESULT */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  padding:6px;
  border-bottom:1px solid var(--border);
  font-size:.85rem;
}
th{color:#9fd9ff}

/* MODAL */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.65);
  padding:20px;
}
.modal-content{
  background:var(--card);
  padding:18px;
  border-radius:14px;
  max-width:600px;
  margin:auto;
}
.close{text-align:right;cursor:pointer;color:var(--muted)}

footer{
  text-align:center;
  font-size:.7rem;
  color:var(--muted);
  padding:10px;
}
</style>
</head>

<body>
<div class="app">

<!-- HEADER -->
<div class="header">
  <img src="logo.png">
  <div>
    <h1>KM Real World SQL</h1>
    <p>Learn SQL the way companies use it</p>
  </div>
  <div class="toggle" onclick="document.body.classList.toggle('light')">üåô</div>
</div>

<div class="main">

<div class="card">
  <strong id="progressText"></strong>
  <div class="bar"><div class="fill" id="progressFill"></div></div>

  <h2 id="taskTitle"></h2>
  <p id="taskDesc" style="color:var(--muted)"></p>

  <div class="practice">
    <label>Choose field</label>
    <select id="fieldSelect" onchange="changeField()"></select>

    <label>Select task</label>
    <select id="taskSelect" onchange="changeTask()"></select>

    <textarea id="sqlBox"></textarea>

    <button onclick="runQuery()">‚ñ∂ Run Query</button>
    <button onclick="openModal()">‚ùó Understand this</button>

    <div id="result"></div>
  </div>
</div>

</div>

<footer>¬© 2025 KM Real World SQL</footer>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-content">
    <div class="close" onclick="closeModal()">‚úñ</div>
    <h3>How to think</h3>
    <p id="explainText"></p>
  </div>
</div>

<script>
// ---------------- DATA ----------------
const tasks={
Hospitality:[
["Show all guests","View all guests","SELECT * FROM guests;","Gets all guest rows","SELECT * returns everything"],
["Checked-in guests","Filter by status","SELECT * FROM guests WHERE status='Checked-in';","Uses WHERE","WHERE filters rows"],
["Indian guests","Filter country","SELECT * FROM guests WHERE country='India';","Country filter","Simple condition"],
["Checked-in Indians","AND usage","SELECT * FROM guests WHERE status='Checked-in' AND country='India';","AND logic","AND joins conditions"],
["Room 101 or 103","OR usage","SELECT * FROM guests WHERE room_no=101 OR room_no=103;","OR logic","OR gives choices"]
]
};

const fakeDB={
Hospitality:[
{ id:1,name:"Arjun",room_no:101,status:"Checked-in",country:"India",vip:"Yes"},
{ id:2,name:"Sana",room_no:102,status:"Checked-out",country:"UAE",vip:"No"},
{ id:3,name:"Rahul",room_no:103,status:"Checked-in",country:"India",vip:"No"}
]
};

let fieldSelect=document.getElementById("fieldSelect");
let taskSelect=document.getElementById("taskSelect");

function loadFields(){
  Object.keys(tasks).forEach(f=>{
    let o=document.createElement("option");
    o.value=f;o.textContent=f;
    fieldSelect.appendChild(o);
  });
}

function changeField(){
  loadTasks();
}

function loadTasks(){
  taskSelect.innerHTML="";
  tasks[fieldSelect.value].forEach((t,i)=>{
    let o=document.createElement("option");
    o.value=i;o.textContent=`Task ${i+1}: ${t[0]}`;
    taskSelect.appendChild(o);
  });
  changeTask();
}

function changeTask(){
  let f=fieldSelect.value;
  let i=taskSelect.value;
  let t=tasks[f][i];
  taskTitle.innerText=t[0];
  taskDesc.innerText=t[1];
  sqlBox.value=t[2];
  explainText.innerText=t[4];
  progressText.innerText=`${f} ¬∑ Task ${+i+1} of ${tasks[f].length}`;
  progressFill.style.width=((+i+1)/tasks[f].length*100)+"%";
}

function runQuery(){
  let query=sqlBox.value.toLowerCase().trim();
  let rows=[...fakeDB[fieldSelect.value]];

  if(query.includes("where")){
    let c=query.split("where")[1].replace(";","").trim();
    if(c.includes(" and ")){
      let p=c.split(" and ");
      rows=rows.filter(r=>p.every(x=>match(r,x)));
    }else if(c.includes(" or ")){
      let p=c.split(" or ");
      rows=rows.filter(r=>p.some(x=>match(r,x)));
    }else{
      rows=rows.filter(r=>match(r,c));
    }
  }
  render(rows);
}

function match(r,c){
  let [k,v]=c.split("=");
  if(!k||!v)return false;
  k=k.trim();v=v.replace(/'/g,"").trim();
  if(!(k in r))return false;
  return r[k]==v || r[k]==Number(v);
}

function render(rows){
  let out=document.getElementById("result");
  if(!rows.length){out.innerHTML="<p>No results found</p>";return;}
  let h="<table><tr>";
  Object.keys(rows[0]).forEach(k=>h+=`<th>${k}</th>`);
  h+="</tr>";
  rows.forEach(r=>{
    h+="<tr>";
    Object.values(r).forEach(v=>h+=`<td>${v}</td>`);
    h+="</tr>";
  });
  h+="</table>";
  out.innerHTML=h;
}

function openModal(){modal.style.display="block";}
function closeModal(){modal.style.display="none";}

loadFields();
changeField();
</script>

</body>
</html>
